#include "quadrature_formula_3d.cuh"

std::vector<GaussPoint3D> createCellQuadratureFormula(int index){
    std::vector<GaussPoint3D> GaussPoints;
    
    std::vector<Point4> coordinates;
    std::vector<double> weights;

    switch (index)
    {
    case 0:	//Quadrature formula with 4 Gauss points (2nd order)
        coordinates = {
            {0.128515707071765, 0.139571690967945, 0.621705865573422},
            {0.608054478991729, 0.137352730077163, 0.145898694726675},
            {0.161734727754746, 0.159340192246828, 0.160612296342170},
            {0.137448101688511, 0.615380511289739, 0.135300542338320}
        };
        weights = {	0.213074006319707, 0.225533192268079, 0.342484823577903, 0.218907977834312 };
        break;
    case 1: //Quadrature formula with 6 Gauss points (3rd order)
        coordinates = {
            {0.0701026973651683, 0.166660699730426, 0.596575741463645},
            {0.168695371477743, 0.584652626698847, 0.168695218708539},
            {0.418175789241166, 0.0803037256707293, 0.418101348156118},
            {0.596576288848820, 0.166672635105983, 0.0700786026978242},
            {0.164808547352848, 0.0851134715186107, 0.164808684755350},
            {0.0731475667668616, 0.440339136918213, 0.0731570614497775}
        };
        weights = { 0.180396407632724, 0.193316294293662, 0.133594798870359,
                    0.180371079146698, 0.201016720944591, 0.111304699111967 };
        break;
    case 2: //Quadrature formula with 11 Gauss points (4th order)
        coordinates = {
            {0.118728074080577, 0.488139312218335, 0.310812027444179},
            {0.00541571307196558, 0.0286201080244151, 0.114481145103298},
            {0.446993110669265, 0.120114931119970, 0.332488124672645},
            {0.0126872452591733, 0.190150550188710, 0.585291075471326},
            {0.0427958329505531, 0.819345052438363, 0.0267193517141523},
            {0.0919178668344217, 0.337218262304316, 0.112649133107395},
            {0.340216417701117, 0.0865574846798660, 0.0793918773870708},
            {0.750977943072010, 0.0796925241935778, 0.0632965941138890},
            {0.145047758851679, 0.0612068933310174, 0.442997468087453},
            {0.394091337029761, 0.439578878471171, 0.0577415505657757},
            {0.131683426201617, 0.0852268026657049, 0.774284002090892}
        };
        weights = { 0.141866572546585, 0.0247320824310707, 0.152919022432934,
                    0.0548181473315377, 0.0316967233772401, 0.151563297845794,
                    0.116968246154425, 0.0569456717776584, 0.117132462663518,
                    0.111295566773725, 0.0400622066655129 };
        break;
    case 3: //Quadrature formula with 14 Gauss points (5th order)
        coordinates = {
            {0.310885919263301, 0.310885919263301, 0.310885919263301},
            {0.454496295874350, 0.454496295874350, 0.0455037041256496},
            {0.0455037041256496, 0.454496295874350, 0.454496295874350},
            {0.454496295874350, 0.0455037041256496, 0.0455037041256496},
            {0.0927352503108912, 0.0927352503108912, 0.721794249067326},
            {0.310885919263301, 0.310885919263301, 0.0673422422100982},
            {0.0927352503108912, 0.0927352503108912, 0.0927352503108912},
            {0.0927352503108912, 0.721794249067326, 0.0927352503108912},
            {0.310885919263301, 0.0673422422100982, 0.310885919263301},
            {0.721794249067326, 0.0927352503108912, 0.0927352503108912},
            {0.0673422422100982, 0.310885919263301, 0.310885919263301},
            {0.0455037041256496, 0.0455037041256496, 0.454496295874350},
            {0.0455037041256496, 0.454496295874350, 0.0455037041256496},
            {0.454496295874350, 0.0455037041256496, 0.454496295874350}
        };
        weights = { 0.112687925718016, 0.0425460207770815, 0.0425460207770815,
                    0.0425460207770815, 0.0734930431163619, 0.112687925718016,
                    0.0734930431163619, 0.0734930431163619, 0.112687925718016,
                    0.0734930431163619, 0.112687925718016, 0.0425460207770815,
                    0.0425460207770815, 0.0425460207770815	};
        break;
    case 4: //Quadrature formula with 23 Gauss points (6th order)
        coordinates = {
            {0.874616888567068, 0.00165024143968754, 0.104298303780294},
            {0.162437774336481, 0.0486578256639518, 0.555486554692278},
            {0.625595673327035, 0.216784059585166, 0.133572971716192},
            {0.0485590349854997, 0.315234134256591, 0.0777799447906708},
            {0.212391390843085, 0.551204621552678, 0.191129825373899},
            {0.0802502491180986, 0.873512812761488, 0.0233398227879653},
            {0.00204528437132775, 0.0619185737602200, 0.382110521336841},
            {0.743045447076817, 0.111673587612288, 0.00140097149271362},
            {0.291249165644977, 0.220190306749827, 0.0156772928654808},
            {0.512051241017705, 0.0114046111258490, 0.414786688769785},
            {0.00119572892701059, 0.680301784905681, 0.235050538574610},
            {0.418255642800152, 0.502924384853926, 0.00148234925880638},
            {0.0756495057730944, 0.332321141871628, 0.540372257953982},
            {0.548024921362051, 0.0596672164470001, 0.154596349445486},
            {0.141008504673563, 0.0508937313254425, 0.806281245135997},
            {0.216600806219125, 0.0686003114916990, 0.216867091164197},
            {0.424691036866569, 0.00848012191959868, 0.00261459286987617},
            {0.334049658549678, 0.309894633544695, 0.128457262465984},
            {0.333761349466911, 0.173167225575504, 0.417350347836307},
            {0.0767039739434372, 0.301735680571604, 0.327492235023629},
            {0.0718764126292230, 0.0628888824345865, 0.0670609374784439},
            {0.00673962768127925, 0.0904745895996606, 0.766896445575367},
            {0.0840955445837732, 0.621120483149686, 0.0555145530701309}
        };
        weights = { 0.00720513335033778, 0.0647230234809383, 0.0417561289814203,
                    0.0468866591949777, 0.0642626547049837, 0.00971071991404364,
                    0.0228306507632138, 0.0203977040996243, 0.0396800192984899,
                    0.0213303550447111, 0.0211633942380321, 0.0236703215432329,
                    0.0490532969018373, 0.0690790231378502, 0.0143311064677154,
                    0.0836591697123374, 0.0108464892755929, 0.102524062480595,
                    0.0830129194149180, 0.101710545807978, 0.0295527967164589,
                    0.0200739965400799, 0.0525398289306307 };
        break;
    case 5: //Quadrature formula with 31 Gauss points (7th order)
        coordinates = {
            {0.300241657297389, 0.0343958764090098, 0.0363574344558376},
            {0.456274874842101, 0.177094933633892, 0.202380043682612},
            {0.0435156707057980, 0.190708046390239, 0.515611955473718},
            {0.0674704268652056, 0.624805208850693, 0.286470491129705},
            {0.0351757962004401, 0.300932453666974, 0.626389945605234},
            {0.0465586231823698, 0.278269467014770, 0.190468606380694},
            {0.0270400007458065, 0.0592553513707679, 0.308553842211534},
            {0.264680100531844, 0.197149327251644, 0.0649765422855217},
            {0.0584308870280592, 0.817899562157666, 0.0603892349556299},
            {0.277767315964989, 0.0476736573398107, 0.479373996738207},
            {0.0555146373286111, 0.286921706513845, 0.0272494808480173},
            {0.0203746164592837, 0.612558396645052, 0.0623018163296930},
            {0.192224498552026, 0.0430284938334260, 0.248571305669355},
            {0.199108791899590, 0.264232528640043, 0.471867679291237},
            {0.623552582635438, 0.289431061035916, 0.0514831192758013},
            {0.0594225690096153, 0.0588796306801409, 0.0637892658968220},
            {0.502832863683403, 0.0311436212022760, 0.160314445663262},
            {0.164630125877445, 0.520176572864711, 0.0228729142743443},
            {0.289131288099980, 0.624198280058974, 0.0347318401180658},
            {0.457959217837902, 0.305196692083038, 0.0380160294851375},
            {0.522678873428334, 0.164195619120587, 0.293643991233235},
            {0.817797025199447, 0.0583606514742921, 0.0635452593856531},
            {0.305313544878443, 0.460399593495120, 0.196571194518918},
            {0.610694728219322, 0.0202214855799755, 0.305592531726566},
            {0.0585696402354899, 0.0598781112217250, 0.818404527991654},
            {0.194718377666173, 0.198039077172379, 0.301528337903182},
            {0.285833345790798, 0.0547185573312178, 0.629688451467908},
            {0.0304091940099104, 0.501248640342412, 0.304224465127423},
            {0.0597170815760429, 0.0259590154076464, 0.609378651041917},
            {0.176570652140718, 0.455361494407224, 0.167629404731700},
            {0.626230724573267, 0.0680576181199524, 0.0198791666412824}
        };
        weights = { 0.0174634934965630, 0.0649822804683735, 0.0432909419411822,
            0.0196966183096976, 0.0180366045230775, 0.0465789789500726,
            0.0208255919856109, 0.0575425216335697, 0.0211946516501726,
            0.0471883811637116, 0.0196501591898121, 0.0184820837344790,
            0.0427447011008647, 0.0576407228457825, 0.0223576139136418,
            0.0212191384526023, 0.0338728685733352, 0.0267949357580909,
            0.0221039803504899, 0.0373559578225954, 0.0251715053465832,
            0.0212351686583526, 0.0372351990949499, 0.0187255497284156,
            0.0210410571517633, 0.0605315353356269, 0.0204610032387521,
            0.0335109231569724, 0.0203462573214307, 0.0635654486690693,
            0.0191541264343591 };
        break;
    default:
        break;
    }

    GaussPoints.reserve(coordinates.size());
    for(int i = 0; i < coordinates.size(); ++i){
        GaussPoint3D gp;
        gp.coordinates.x = coordinates[i].x;
        gp.coordinates.y = coordinates[i].y;
        gp.coordinates.z = coordinates[i].z;
        gp.coordinates.w = 1.0 - coordinates[i].x - coordinates[i].y - coordinates[i].z;
        gp.weight = weights[i];
        GaussPoints.push_back(gp);
    }

    return GaussPoints;
}
